<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title><%= arr[0].username %>'s Profile</title>
  <link rel="stylesheet" href="/stylesheets/centered-columns.css">
</head>

<body>

  <% if(parseInt(user.access_level) === 10) { %>
    <% if(arr.length !== 1) { %>
      <!-- if admin requests his profile page: @ the top of the page is info about himself,
      then - the userlist with pagination -->
      <div class="container-fluid">
        <div class="row row-centered">
          <div class="col-sm-6 col-md-3 col-centered">
            <div class="thumbnail">
              <img src="/images/users/<%= user._id %>/avatar.jpg" alt="<%= user.username %>_avatar">
              <div class="caption">
                <h3><%= user.username %></h3>
                <% if(parseInt(user.access_level) === 10) { %>
                  <p>Access level: <%= user.access_level %></p>
                <% } %>
                <p>Name: <%= user.name %></p>
                <p>E-mail: <%= user.email %></p>
                <form action="/users/profile/<%= user.username %>" enctype="multipart/form-data" method="POST">
                  <div class="form-group">
                    <label>Avatar</label>
                    <input type="file" accept="image/*" class="form-control" name="avatar" required>
                  </div>
                  <input type="submit" class="btn btn-warning" value='Upload new avatar' />
                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <% for (let i = 0; i < 4; i++) { %>
            <% for (let j = 0; j < arr.length - i * 4; j++) { %>
              <div class="col-sm-6 col-md-3">
                <div class="thumbnail">
                  <img src="<%= arr[i * 4 + j].img_path %>" alt="<%= arr[i * 4 + j].username %>_avatar">
                  <div class="caption">
                    <h3><%= arr[i * 4 + j].username %></h3>
                    <p><a href="<%= arr[i * 4 + j].href %>" class="btn btn-info" role="button">User's page</a></p>
                  </div>
                </div>
              </div>
            <% } %>
          <% } %>
        </div>
      </div>

      <!-- if admin requests his profile page:
      at the bottom is pagination -->
      <div class="container-fluid">
        <div class="col-md-4 col-md-offset-5">
          <nav aria-label="Page navigation">
          <ul class="pagination">
            <% if (curPage <= 1) { %>
              <li class="disabled">
                <span>
                  <span aria-hidden="true">&laquo;</span>
                </span>
              </li>
            <% } %>
            <% if (curPage > 1) { %>
              <li>
                <a href="/users/profile/<% user.username %>?page=<%= (curPage - 1) %>" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
            <% } %>
            <% if (curPage > 1) { %>
              <li><a href="/users/profile/<% user.username %>?page=<%= (curPage - 1) %>"><%= (curPage - 1) %></a></li>
            <% } %>
            <li class="active">
              <span><%= curPage %> <span class="sr-only">(current)</span></span>
            </li>
            <% if (curPage < maxPage) { %>
              <li><a href="/users/profile/<% user.username %>?page=<%= (curPage - -1) %>"><%= (curPage - -1) %></a></li>
              <li>
                <a href="/users/profile/<% user.username %>?page=<%= (curPage - -1) %>" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            <% } %>
            <% if (curPage >= maxPage) { %>
              <li class="disabled">
                <span>
                  <span aria-hidden="true">&raquo;</span>
                </span>
              </li>
            <% } %>
          </ul>
        </nav>
        </div>
      </div>

      <!-- if admin requests his profile page:
      the button to add the band is also at the bottom -->
      <% if(parseInt(user.access_level) === 10) { %>
        <div class="container-fluid">
          <div class="text-center">
              <a href="/addband">Add new band</a>
          </div>
        </div>
      <% } %>
    <% } %>
  <% } %>

  <!-- if someone requests any profile page: @ the top of the page is info about the requested user -->
  <% if(arr.length === 1) { %>
    <div class="row row-centered">
      <div class="col-sm-6 col-md-3 col-centered">
        <div class="thumbnail">
          <img src="<%= arr[0].img_path %>" alt="<%= arr[0].username %>_avatar">
          <div class="caption">
            <h3><%= arr[0].username %></h3>
            <% if(parseInt(user.access_level) === 10) { %>
              <p>Access level: <%= arr[0].access_level %></p>
            <% } %>
            <p>Name: <%= arr[0].name %></p>
            <p>E-mail: <%= arr[0].email %></p>
            <% if(arr[0].username === user.username) { %>
              <form action="/users/profile/<%= user.username %>" enctype="multipart/form-data" method="POST">
                <div class="form-group">
                  <label>Avatar</label>
                  <input type="file" accept="image/*" class="form-control" name="avatar" required>
                </div>
                <input type="submit" class="btn btn-warning" value='Upload new avatar' />
              </form>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  <% } %>

  <!-- if someone is not on his profile: show the link to go back to your profile -->
  <% if(user.username != arr[0].username) { %>
    <div class="container-fluid">
      <div class="text-center">
        <a href="/users/profile/<%= user.username %>">Back to your profile</a>
      </div>
    </div>
  <% } %>

  <!-- <script src="js/scripts.js"></script> -->
</body>

</html>
